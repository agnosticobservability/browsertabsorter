<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="devtools.css" />
    <title>Tab Sorter DevTools</title>
  </head>
  <body>
    <header>
      <h1>Tab Sorter Developer Tools</h1>
      <div style="display: flex; gap: 8px; align-items: center;">
        <button id="refreshBtn">Refresh Data</button>
      </div>
    </header>

    <nav class="tabs-nav">
      <button class="tab-btn active" data-target="view-tabs">Tab Data</button>
      <button class="tab-btn" data-target="view-algorithms">Algorithms & Simulation</button>
      <button class="tab-btn" data-target="view-strategies">Strategy Manager</button>
    </nav>

    <main>
      <section id="view-tabs" class="view-section active">
        <div id="stats">
          <span>Total Tabs: <span id="totalTabs">0</span></span>
        </div>

        <div class="table-toolbar">
            <div class="search-container">
                <input type="text" id="globalSearch" placeholder="Search all columns..." />
            </div>
            <div class="columns-menu-container">
                <button id="columnsBtn">Columns â–¾</button>
                <div id="columnsMenu" class="columns-menu hidden">
                    <!-- Checkboxes populated by JS -->
                </div>
            </div>
            <button id="resetViewBtn" class="small-btn">Reset View</button>
        </div>

        <div class="table-container">
          <table id="tabsTable">
            <thead>
              <tr id="headerRow">
                <!-- Headers populated by JS to support reordering/resizing -->
              </tr>
              <tr id="filterRow">
                <!-- Filter inputs populated by JS -->
              </tr>
            </thead>
            <tbody>
              <!-- Rows will be populated here -->
            </tbody>
          </table>
        </div>
      </section>

      <section id="view-algorithms" class="view-section">
        <div class="algo-container">

          <div class="algo-card">
            <h2>Grouping & Sorting Simulation</h2>
            <p>Simulate how the current tabs would be organized using different strategies. Drag to reorder.</p>

            <div class="simulation-config">
              <div class="config-section">
                <h3>Grouping Strategies</h3>
                <div class="strategy-list-container" id="sim-grouping-list">
                  <!-- Injected by JS -->
                </div>
              </div>

              <div class="config-section">
                <h3>Sorting Strategies</h3>
                <div class="strategy-list-container" id="sim-sorting-list">
                   <!-- Injected by JS -->
                </div>
              </div>
            </div>

            <div class="action-buttons">
              <button id="runSimBtn">Run Simulation</button>
              <button id="applyBtn" class="success-btn">Apply to Browser</button>
            </div>

            <div id="simResults" class="simulation-results">
              <!-- Results will be injected here -->
              <p style="color: #666; font-style: italic;">Click "Run Simulation" to see results.</p>
            </div>
          </div>

          <div class="algo-card">
            <h2>Strategy Reference</h2>

            <h3>Grouping Strategies</h3>
            <div class="strategy-list" id="grouping-ref">
               <!-- Populated by JS -->
            </div>

            <h3 style="margin-top: 20px;">Sorting Strategies</h3>
            <div class="strategy-list" id="sorting-ref">
               <!-- Populated by JS -->
            </div>

            <h3 style="margin-top: 20px;">Data Registries</h3>
            <div class="strategy-list" id="registry-ref">
               <!-- Populated by JS -->
            </div>
          </div>

        </div>
      </section>

      <section id="view-strategies" class="view-section">
        <div class="algo-container">
          <div class="algo-card" style="width: 100%;">
            <div style="display: flex; justify-content: space-between; align-items: center;">
                <h2>Tab Sorter Strategy Builder</h2>
                <div>
                   <button id="builder-run-btn">Run</button>
                   <button id="builder-save-btn">Save Strategy</button>
                </div>
            </div>

            <!-- Header Inputs -->
            <div style="margin-bottom: 20px; display: flex; gap: 10px;">
                <input type="text" id="strat-id" placeholder="ID (e.g. social_workflow)" style="padding: 5px;">
                <input type="text" id="strat-label" placeholder="Label (e.g. Social Workflow)" style="flex: 1; padding: 5px;">
                <input type="text" id="strat-fallback" placeholder="Fallback Group (e.g. Misc)" style="padding: 5px;">
                <label style="display: flex; align-items: center; gap: 5px; cursor: pointer;">
                    <input type="checkbox" id="strat-autorun"> Auto Run
                </label>
                <label style="display: flex; align-items: center; gap: 5px; cursor: pointer; margin-left: 10px;">
                    <input type="checkbox" id="strat-sortgroups"> Sort Groups
                </label>
            </div>

            <!-- 1. FILTER -->
            <div class="builder-section">
                <h3>Filter all of these conditions must be met</h3>
                <div id="filter-rows-container"></div>
                <!-- Controls added per row, but maybe a main Add button too if needed, mockup shows per-row controls? Actually no, mockup shows buttons on the right of rows. -->
                <button id="add-filter-btn" class="add-row-btn">+ Add Filter Condition</button>
            </div>

            <!-- 2. GROUP -->
            <div class="builder-section">
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <h3>Group results by the following fields</h3>
                    <div>
                         <button id="add-group-btn" class="add-row-btn">Add Group</button>
                    </div>
                </div>
                <div id="group-rows-container"></div>
            </div>

            <!-- 3. SORT -->
            <div class="builder-section">
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <h3>Sort results by the following fields</h3>
                     <div>
                         <button id="add-sort-btn" class="add-row-btn">Add Sort</button>
                    </div>
                </div>
                <div id="sort-rows-container"></div>
            </div>

            <!-- Breadcrumb -->
            <div class="breadcrumb-container">
                <p id="strategy-breadcrumb">All ></p>
            </div>

            <!-- Builder Simulation Results -->
             <div id="builder-results" style="margin-top: 20px; border-top: 1px solid #eee; padding-top: 10px;">
                <!-- Simulation results appear here -->
             </div>


            <hr style="margin: 40px 0;">

            <h4>Existing Custom Strategies</h4>
            <div id="custom-strategies-list" style="max-height: 400px; overflow-y: auto;">
                <!-- All strategies populated by JS -->
            </div>

            <div id="custom-genera-container" style="margin-top: 40px; border-top: 1px solid #eee; padding-top: 15px;">
              <h3>Custom Genera</h3>
              <p>Map specific domains to categories.</p>
              <div style="display: flex; gap: 10px; margin-bottom: 10px;">
                <input type="text" id="new-genera-domain" placeholder="Domain (e.g. example.com)" style="flex: 1; padding: 5px;">
                <input type="text" id="new-genera-category" placeholder="Category (e.g. Work)" style="flex: 1; padding: 5px;">
                <button id="add-genera-btn" style="padding: 5px 15px;">Add</button>
              </div>
              <div id="custom-genera-list" style="max-height: 200px; overflow-y: auto;">
                <!-- Custom entries populated by JS -->
              </div>
            </div>

          </div>
        </div>
      </section>
    </main>

    <script type="module" src="../dist/ui/devtools.js"></script>
  </body>
</html>
